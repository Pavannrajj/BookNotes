<!DOCTYPE html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%-userName%> (edit)</title>
    <link rel="stylesheet" href="./styles/user.css">
    <link rel="stylesheet" href="./styles/footer.css">

</head>
<body>
    <div class = "navbar">
        <img src="./static/logo.jpg" alt="BookNotes Logo">
        
        <h1><%-userName%> > <%-bookName%> with book id  <%-book_id%></h1> 
    </div>
    <div id = "secondBar">
        <img src="<%-imageUrl%>" alt = "<%-imageUrl%> book cover"></img>
        <div class = "bookDetails">
        <h1>Book Name : <%-bookName%></h1>
        <h1>Author : <%-author%></h1>
        
    </div>
    </div>
    
    <div id ="thirdBar">
        <div id = "pre-thirdBar">
        <h1>Notes</h1>
        <button  id="handler2" onclick="handler2()" style="margin-top: 30px; width:fit-content; ">Add-note</button>
        </div>
   
        <div class = "notes">
            <div class="note" id="newNote" style="display: none;">
                <div class="ThirdBar-firstRow ">
                    <h2>New note</h2>
                </div>
                    <form action="/addNote" method="post">
                    <input class="editContent" id="edit" type="text" name="newNote" placeholder="type here..." autocomplete="off" autofocus="true" >
                    <div class="submit-button"> 
                    <input type="submit" value="submit" >
                    </form>
                    </div>
            </div>
        <% notes.forEach((note)=>{%>
            <div class = "note">
                <div class="ThirdBar-firstRow">
                <p>Date :<%-note.time%></p>
                <div class="ThirdBar-firstRow-second">
                    <form action="/deleteNote" method="get" >
                        <input type="hidden" name="noteId" value="<%-note.note_id%>">
                        <button type="submit" style="background: none; border: none; cursor: pointer;">
                            <img src="https://www.svgrepo.com/show/41586/garbage.svg" alt="delete button" >
                        </button>
                    </form>
                    
                        <button id="editButton<%-note.note_id%>" onclick="handler('<%=note.note_id%>')">
                        <svg class="feather feather-edit" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
                        </button>
                       

                    
                </div>
                </div>
                <form action="/updateNote" method="get">
                <input class="editContent" id="edit<%=note.note_id%>" type="text" name="updatednote" value="<%-note.note%>" autocomplete="off" autofocus="true" hidden="true">
                <div class="content" id="note<%=note.note_id%>">
                <h1><%-note.note%></h1>
                </div>
                <div class="submit-button">
                 
                    <input type="hidden" name="note_id" value=<%-note.note_id%>>
                    <input id="button<%-note.note_id%>"  type="submit" value="change note" hidden />
                </form>
            </div>
            </div>
        
        <%})%>
        </div>
    </div>


<script>
    const imageUrl = <%-JSON.stringify(imageUrl)%>
    console.log(imageUrl)
    const container = document.getElementById("secondBar")
    const img = document.getElementsByTagName('img');
        img.src = imageUrl;
        img.alt = 'book cover';
        img.style.width = "100px";
        img.style.height = "200px";
        img.style.margin = "10px";
        container.appendChild(img);

    function handler(note_id){
        console.log("note id :",note_id)
        document.getElementById("note" + note_id).style.backgroundColor = "lightblue"; 
        document.getElementById("note"+note_id).setAttribute("hidden",true)
        document.getElementById("editButton"+note_id).setAttribute("hidden",true)
        document.getElementById("button"+note_id).removeAttribute("hidden")
        const input = document.getElementById("edit"+note_id)
        input.removeAttribute("hidden")
        const val = input.value;
        input.value = '';        
        input.value = val;
        input.focus()
    }
    function handler2(){
       const input =  document.getElementById("newNote")
        
        input.style.removeProperty("display");
    const input2 = document.getElementById("handler2")
    const val = input.value;
        
    }
</script>

<%-include('./partials/footer.ejs')%>